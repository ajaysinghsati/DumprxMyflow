env:
  # Telegram
  TG_CHAT: "@DumprXDumps"
  TG_TOKEN: ENCRYPTED[2a89720bfbe3d4987b7957bfe6cb250027ccc85106ef5089ac5f335e4cd53b84795fba8b110e8c8888427a35088c9702]
  
  # Gitlab
  PUSH_TO_GITLAB: true
  GITLAB_GROUP: romdump
  GITLAB_TOKEN: glpat-98RQVHwDyxQKFkCXx5Y2
  GITLAB_INSTANCE: www.opencode.net
  
  # Private SSH Key
  PRIV_SSH_KEY: -----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAy/vIFfrF+4YCOtPwdMnlOXjq7QU+SI2abdUaaSt4byjYkfvHs0UY
ctmzLsa9ozI43Ch5g8Ua0I/y6q8YUXMk504P0yH6dEBxg2IM9bcGxNA8OdZMdtWQoSkT4B
IA7T+AMWS4DnBVNuKvi3rCC7JeWXNNtyRiFib1h5t3uUzRTTlPHQkGaxDMacX7UH4bY6ET
qzYOZ0TJuybaHpUL6mPzRpFrW4TbwqLutpkjCcpK+yxPK8a3Ix74TD8FnIxLvAOc5NewQR
gXvpX7RChryEHF7OIHoa6368xMf5KZCWXIgzVgjZRmcm1zXF7fm39avXAiUbLtgxCNSNBx
MLsGHSldurMF1PVMJlizXJsrDaq0F5vvui9m7AczGmZ/tGgmiNMXbwO3372Fmn/1vd6atB
M60JY0Dp4Diitxko9kX0XWObc09ywHk1vcDrFY3hW+IWjxjymt5xqpQHm82dzDjT0UYMzE
GKMUNx8JAEpIbe6y/rsF/Vn+RCbmNfvESsh7x5TNAAAFkJxGN4KcRjeCAAAAB3NzaC1yc2
EAAAGBAMv7yBX6xfuGAjrT8HTJ5Tl46u0FPkiNmm3VGmkreG8o2JH7x7NFGHLZsy7GvaMy
ONwoeYPFGtCP8uqvGFFzJOdOD9Mh+nRAcYNiDPW3BsTQPDnWTHbVkKEpE+ASAO0/gDFkuA
5wVTbir4t6wguyXllzTbckYhYm9Yebd7lM0U05Tx0JBmsQzGnF+1B+G2OhE6s2DmdEybsm
2h6VC+pj80aRa1uE28Ki7raZIwnKSvssTyvGtyMe+Ew/BZyMS7wDnOTXsEEYF76V+0Qoa8
hBxeziB6Gut+vMTH+SmQllyIM1YI2UZnJtc1xe35t/Wr1wIlGy7YMQjUjQcTC7Bh0pXbqz
BdT1TCZYs1ybKw2qtBeb77ovZuwHMxpmf7RoJojTF28Dt9+9hZp/9b3emrQTOtCWNA6eA4
orcZKPZF9F1jm3NPcsB5Nb3A6xWN4VviFo8Y8precaqUB5vNncw409FGDMxBijFDcfCQBK
SG3usv67Bf1Z/kQm5jX7xErIe8eUzQAAAAMBAAEAAAGBAIexOezFISasgpc3nWFTXNTahw
yczE3fRLeDZ0pGzJrFhSu3XaT3dcgQ4Y1gT45cPk7V7d+mIqxS1bkgOQEVo5rq5sQAemcS
53AKraxW0H3kN+wRjlQOxWMvvDT2RP+Nmm1BHt8cAtO8ACK8ypCVWwYOGciWv1kVGYfX99
CgNSs10Fb0Rfy68//437Ev8nBYGoluMC6qJ7gDpF1rsL1/N7ndypjazIWxdTKqtBAzLaXg
V9o7GmCWnX26/rSg71Bm5as25S6y5nQSp9Qld5+IBm1uH2eUUK6K90Oj5JcA6TGBYn+0AQ
bMU5V/sGSQ/i/8MhTKEr0LXQ/+EW7KKQkwtR+q4bhBZ+87dtc11geBS2xT/HGtC6/K/IF8
M8u20aT6CUERXEUsrqCwthpi5++LpLz6WpignDoUZvxxXtdkuhgxjEtrL1IdYqzv+bd/tt
X1sB25tXjczL0jdU7HC53KRGbFj/d+Hm8ZdaME0P+Af25V/9tOqVgr3m2B2jjLPr1CUQAA
AMEAtb9SMru4gslqoQ1UdFXj5rrXu9dAKwqXCi0mmPAxs8G8p02qFlzupdzfHFI+R4DCHB
W0gDwB4yfL6Pd6y9WtV0GAJc28raXOyPCOvaZCNmRp3lPOkGWIAVBOMQbXUK5KP0my0RBt
YjmuzE1yotp0MWb/34w5QQxp5LW+vgQRxP03gMo+LUGhb0i8B/OpCp2a8dhJZqubv4ns73
OaFyGNFqDvViQnXeIEOPEVDHM2nYRoFbXKh3bzMwx6BV7xcpoFAAAAwQDwmSz67t4w5ir2
atiLOg1ZpreZ/F0hj0f67+5tbqcAu4aZ8YnLzJTA1/gAtcS7s8BmqNTG5q9R7nsdmLLcHx
BQKOxKJ9nu8705Q+DDPF1JuPXyLTbXL7A14jJKZaBf6xFA/qrAYZRVvK79grhQouD02+8U
LVytk2gxLsS5Ec1XM8zp/UPuI4q16laUQiRi5cu208X7YWHFQuaAiS9XhBcv10siUVzlxp
zk5LPRYk4FiOyuAhNHwrXEwIrflMOC3P8AAADBANkKk9753Y4ybueC7Q1ZzSp4YKZcyO8L
9pkBOreOLwBVy/I8VK8BfKBwuHZBPj+XHiX4jbZfgI4JG6awyIkRpAQDOKVZe5uleM/P8V
sWl714wbRpFRyf0Y1w8MC8tWVqEPdYzZJORfuxvNU179s7bhQC2eCPfK8p5K/BkH6mvkfA
GPvf8dDhef3WlvMTVZgzHFXw1xCER65q8ZUUMXWxpdTxfKTHW66wW8efbq0HSr5lVnFK+N
PR3WEX2jRrIbRyMwAAABdhamF5c2luZ2hzYXRpQGdtYWlsLmNvbQEC
-----END OPENSSH PRIVATE KEY-----
task:
  name: "Firmware Dump by DumprX"
  only_if: $CIRRUS_REPO_OWNER == 'ajaysinghsati'
  skip: $CIRRUS_BRANCH == 'main'
  auto_cancellation: $CIRRUS_BRANCH == 'autocancel'
  timeout_in: 120m
  container:
      image: ghcr.io/sushrut1101/docker:arch
      cpu: 4
      memory: 16G

  Clone_script:
      - git clone --depth=1 --single-branch https://github.com/DumprX/DumprX.git
  
  Set-SSH-Keys_script:
      - mkdir -p ~/.ssh
      - ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts
      - ssh-keyscan -t rsa gitlab.com >> ~/.ssh/known_hosts
      - ssh-keyscan -t rsa $GITLAB_INSTANCE >> ~/.ssh/known_hosts
      - echo "$PRIV_SSH_KEY" > ~/.ssh/id_rsa
      - chmod 600 ~/.ssh/id_rsa

  Setup_script:
      - git config --global user.name "ajaysinghsati"
      - git config --global user.email "ajaysinghsati@gmail.com"
      - cd DumprX
      - echo "$GITLAB_TOKEN" > .gitlab_token
      - echo "$GITLAB_GROUP" > .gitlab_group
      - echo "$TG_CHAT" > .tg_chat
      - echo "$TG_TOKEN" > .tg_token
      - echo "$GITLAB_INSTANCE" > .gitlab_instance
      - sudo bash setup.sh

  DumprX_script:
      - cd DumprX || echo "Already in the Directory"
      - ./dumper.sh $(< ${CIRRUS_WORKING_DIR}/ROM_URL.txt)
